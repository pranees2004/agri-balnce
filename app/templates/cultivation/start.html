{% extends "base.html" %}

{% block title %}Start Cultivation - AgriBalance{% endblock %}

{% block content %}
<div class="page-header">
    <h1 class="page-title">Start New Cultivation</h1>
    <a href="{{ url_for('cultivation.list_cultivations') }}" class="btn btn-outline">
        <i class="fas fa-arrow-left"></i> Back
    </a>
</div>

<div class="grid-2">
    <div class="card">
        <h3 class="card-title mb-20">
            <i class="fas fa-seedling"></i> Cultivation Details
        </h3>
        
        <form method="POST" action="{{ url_for('cultivation.start_cultivation') }}">
            <div class="form-group">
                <label class="form-label" for="land_id">Select Land *</label>
                <select id="land_id" name="land_id" class="form-control" required>
                    <option value="">Choose a land</option>
                    {% for land in lands %}
                    <option value="{{ land.id }}" {{ 'selected' if selected_land and selected_land.id == land.id else '' }}>
                        {{ land.name }} ({{ land.land_size }} {{ land.land_size_unit }})
                    </option>
                    {% endfor %}
                </select>
            </div>
            
            <div class="form-group">
                <label class="form-label" for="crop_name">Crop Name *</label>
                <input type="text" id="crop_name" name="crop_name" class="form-control" 
                       placeholder="e.g., Rice, Wheat, Tomato" required>
            </div>
            
            <div class="form-group">
                <label class="form-label" for="variety">Variety/Type</label>
                <input type="text" id="variety" name="variety" class="form-control" 
                       placeholder="e.g., Basmati, Hybrid">
            </div>
            
            <div class="form-group">
                <label class="form-label" for="planting_date">Planting Date</label>
                <input type="date" id="planting_date" name="planting_date" class="form-control">
            </div>
            
            <div class="form-group">
                <label class="form-label" for="expected_harvest_date">Expected Harvest Date</label>
                <input type="date" id="expected_harvest_date" name="expected_harvest_date" class="form-control">
            </div>
            
            <div class="form-group">
                <label class="form-label" for="notes">Notes</label>
                <textarea id="notes" name="notes" class="form-control" 
                          placeholder="Any additional notes..."></textarea>
            </div>
            
            <div class="flex gap-10">
                <button type="submit" name="get_recommendations" value="1" class="btn btn-secondary btn-large">
                    <i class="fas fa-robot"></i> Get AI Recommendations
                </button>
                <button type="submit" name="save_cultivation" value="1" class="btn btn-primary btn-large">
                    <i class="fas fa-play"></i> Start Cultivation
                </button>
            </div>
        </form>
    </div>
    
    <div class="card">
        <h3 class="card-title mb-20">
            <i class="fas fa-robot"></i> AI Advisory Suggestions
        </h3>
        
        {% if recommendations %}
        <div class="recommendations">
            <div class="recommendation-section">
                <h5><i class="fas fa-leaf"></i> Suitable Crops for Your Soil</h5>
                <ul>
                    {% for crop in recommendations.suitable_crops %}
                    <li>{{ crop }}</li>
                    {% endfor %}
                </ul>
            </div>
            
            <div class="recommendation-section">
                <h5><i class="fas fa-calendar-alt"></i> Best Cultivation Time</h5>
                <p>{{ recommendations.cultivation_time }}</p>
            </div>
            
            <div class="recommendation-section">
                <h5><i class="fas fa-tasks"></i> Crop Management Steps</h5>
                <ul>
                    {% for step in recommendations.management_steps %}
                    <li>{{ step }}</li>
                    {% endfor %}
                </ul>
            </div>
            
            <div class="recommendation-section">
                <h5><i class="fas fa-flask"></i> Nutrient & Fertilizer Guidance</h5>
                <ul>
                    {% for item in recommendations.nutrient_guidance %}
                    <li>{{ item }}</li>
                    {% endfor %}
                </ul>
            </div>
            
            <div class="recommendation-section">
                <h5><i class="fas fa-chart-line"></i> Price Trends & Tips</h5>
                <ul>
                    {% for item in recommendations.price_trends %}
                    <li>{{ item }}</li>
                    {% endfor %}
                </ul>
            </div>
            
            <div class="recommendation-section">
                <h5><i class="fas fa-th-large"></i> Land Usage Suggestions</h5>
                <ul>
                    {% for item in recommendations.land_usage %}
                    <li>{{ item }}</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
        
        <div class="alert alert-warning mt-20">
            <i class="fas fa-exclamation-triangle"></i>
            <span>These are advisory suggestions only. Actual results may vary based on local conditions.</span>
        </div>
        {% else %}
        <div class="empty-state">
            <i class="fas fa-robot"></i>
            <h3>Get AI Recommendations</h3>
            <p>Select a land and click "Get AI Recommendations" to receive personalized crop suggestions based on your soil type, climate, and land details.</p>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}
