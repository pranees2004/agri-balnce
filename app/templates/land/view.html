{% extends "base.html" %}

{% block title %}{{ land.name }} - AgriBalance{% endblock %}

{% block content %}
<div class="page-header">
    <h1 class="page-title">{{ land.name }}</h1>
    <div class="flex gap-10">
        <a href="{{ url_for('land.edit_land', land_id=land.id) }}" class="btn btn-outline">
            <i class="fas fa-edit"></i> Edit
        </a>
        <a href="{{ url_for('cultivation.start_cultivation') }}?land_id={{ land.id }}" class="btn btn-primary">
            <i class="fas fa-seedling"></i> Start Cultivation
        </a>
    </div>
</div>

<div class="grid-2">
    <div class="card">
        <h3 class="card-title mb-20">Land Details</h3>
        
        <div class="list-item">
            <span>Location</span>
            <strong>{{ land.district or '' }}{{ ', ' if land.district and land.state else '' }}{{ land.state or '' }}{{ ', ' if (land.district or land.state) and land.country else '' }}{{ land.country }}</strong>
        </div>
        
        <div class="list-item">
            <span>Land Size</span>
            <strong>{{ land.land_size }} {{ land.land_size_unit }}</strong>
        </div>
        
        <div class="list-item">
            <span>Land Type</span>
            <strong>{{ land.land_type or 'Not specified' }}</strong>
        </div>
        
        <div class="list-item">
            <span>Soil Type</span>
            <strong>{{ land.soil_type or 'Not specified' }}</strong>
        </div>
        
        <div class="list-item">
            <span>Climate</span>
            <strong>{{ land.climate_type or 'Not specified' }}</strong>
        </div>
        
        <div class="list-item">
            <span>Water Source</span>
            <strong>{{ land.water_source or 'Not specified' }}</strong>
        </div>
        
        <div class="list-item">
            <span>Previous Crop</span>
            <strong>{{ land.previous_crop or 'Not specified' }}</strong>
        </div>
        
        {% if land.notes %}
        <div class="mt-20">
            <strong>Notes:</strong>
            <p>{{ land.notes }}</p>
        </div>
        {% endif %}
    </div>
    
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">Cultivation History</h3>
        </div>
        
        {% if land.cultivations.count() > 0 %}
            {% for cultivation in land.cultivations.order_by(None).all()[:5] %}
            <div class="list-item">
                <div class="list-item-info">
                    <h4>{{ cultivation.crop_name }}</h4>
                    <p>{{ cultivation.planting_date.strftime('%b %Y') if cultivation.planting_date else 'Date not set' }}</p>
                </div>
                <span class="badge badge-{{ 'success' if cultivation.status == 'harvested' else 'warning' if cultivation.status == 'active' else 'info' }}">
                    {{ cultivation.status.title() }}
                </span>
            </div>
            {% endfor %}
        {% else %}
            <div class="empty-state">
                <i class="fas fa-seedling"></i>
                <h3>No cultivations yet</h3>
                <p>Start your first cultivation on this land</p>
            </div>
        {% endif %}
    </div>
</div>

<div class="card mt-20">
    <h3 class="card-title text-center mb-20" style="color: var(--error-color);">Danger Zone</h3>
    <form method="POST" action="{{ url_for('land.delete_land', land_id=land.id) }}" 
          onsubmit="return confirm('Are you sure you want to delete this land? This cannot be undone.');">
        <div class="text-center">
            <button type="submit" class="btn btn-danger">
                <i class="fas fa-trash"></i> Delete This Land
            </button>
        </div>
    </form>
</div>
{% endblock %}
