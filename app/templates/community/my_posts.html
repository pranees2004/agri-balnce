{% extends "base.html" %}

{% block title %}My Posts - AgriBalance{% endblock %}

{% block content %}
<div class="page-header">
    <h1 class="page-title">My Posts</h1>
    <a href="{{ url_for('community.create_post') }}" class="btn btn-primary">
        <i class="fas fa-plus"></i> Create Post
    </a>
</div>

{% if posts %}
{% for post in posts %}
<div class="post-card">
    <div class="post-header">
        <div class="post-meta">
            <span>{{ post.created_at.strftime('%d %b %Y') }} â€¢ {{ post.category.replace('-', ' ').title() if post.category else 'General' }}</span>
        </div>
        <div class="flex gap-10">
            <a href="{{ url_for('community.edit_post', post_id=post.id) }}" class="btn btn-outline btn-icon">
                <i class="fas fa-edit"></i>
            </a>
            <form method="POST" action="{{ url_for('community.delete_post', post_id=post.id) }}" 
                  onsubmit="return confirm('Delete this post?');" style="display: inline;">
                <button type="submit" class="btn btn-danger btn-icon">
                    <i class="fas fa-trash"></i>
                </button>
            </form>
        </div>
    </div>
    
    <div class="post-content">
        <h3><a href="{{ url_for('community.view_post', post_id=post.id) }}">{{ post.title }}</a></h3>
        <p>{{ post.content[:150] }}{% if post.content|length > 150 %}...{% endif %}</p>
    </div>
    
    <div class="post-actions">
        <span class="post-action"><i class="fas fa-heart"></i> {{ post.likes }}</span>
        <span class="post-action"><i class="fas fa-comment"></i> {{ post.comments.count() }}</span>
        <span class="post-action"><i class="fas fa-eye"></i> {{ post.views }}</span>
    </div>
</div>
{% endfor %}
{% else %}
<div class="card">
    <div class="empty-state">
        <i class="fas fa-edit"></i>
        <h3>No posts yet</h3>
        <p>Share your farming experiences with the community!</p>
        <a href="{{ url_for('community.create_post') }}" class="btn btn-primary btn-large mt-20">
            Create Your First Post
        </a>
    </div>
</div>
{% endif %}
{% endblock %}
